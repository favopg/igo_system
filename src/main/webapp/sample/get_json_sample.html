<!DOCTYPE html>
<html lang="ja">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>JSONデータをテーブルに表示</title>
	<!-- BootstrapのCSSをCDNから読み込み -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
	<div class="container mt-5">
		<h1>名簿一覧</h1>
		<table class="table table-striped table-bordered">
			<thead class="table-primary">
				<tr>
					<th>ID</th>
					<th>名前</th>
					<th>棋力</th>
					<th>登録日</th>
				</tr>
			</thead>
			<tbody id="table-body">
				<!-- JSONデータがここに挿入されます -->
			</tbody>
		</table>
	</div>

	<!-- JavaScript -->
	<script>

		document.addEventListener('DOMContentLoaded', function () {
			fetch('igo_system')
				.then(response => {
					if (!response.ok) {
						throw new Error('HTTP error ' + response.status);
					}
					return response.json();
				})
				.then(data => {
					// 1件対応
					/**
					var responseJson = JSON.stringify(data, null, 2);
					console.log(data);
					const tableBody = document.getElementById("table-body");
					const tr = document.createElement("tr"); // 新しい行を作成
					tr.innerHTML = `
						<td>${data.id}</td>
						<td>${data.name}</td>
						<td>${data.email}</td>
						<td>${data.created_at}</td>
					`;
					tableBody.appendChild(tr); // 行をtbodyに追加
					*/

					// 複数件対応
					const tableBody = document.getElementById("table-body");
					var responseJson = JSON.stringify(data, null, 2);
					const parsedData = JSON.parse(responseJson);

					parsedData.records.forEach(row => {
						const tr = document.createElement("tr");
						tr.innerHTML = `
					                <td>${row.id}</td>
					                <td>${row.name}</td>
					                <td>${row.chess_ability}</td>
					                <td>${row.created_at}</td>
					            `;
						tableBody.appendChild(tr);
					});
				})
				.catch(error => {
					console.error('エラー:', error);
				});
		});		
	</script>
</body>

</html>